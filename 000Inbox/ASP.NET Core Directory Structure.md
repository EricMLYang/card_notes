---
tags:
  - backend
---
# ASP.NET Core Directory Structure



## Directory Structure

根據您提供的資料夾結構，以下是一些 C# 後端設計概念的介紹，以及一個 API 是如何被建構的。這些概念涵蓋了常見的分層架構、設計模式和最佳實踐，有助於構建可維護、可擴展的後端應用程式。

---

### **1\. 分層架構 (Layered Architecture)**

您的專案資料夾結構展示了一個典型的分層架構，將應用程式劃分為不同的層級，每個層級負責不同的職責。這種架構有助於實現關注點分離（Separation of Concerns），提高代碼的可維護性和可測試性。

#### **主要層級包括：**

- **Web API 層 (`Todo.WebApi`)**

- **業務邏輯層 (`Todo.BLogicService`)**

- **資料存取層 (`Todo.CRepository`)**

- **實體層 (`Todo.DEntity`)**

- **視圖模型層 (`Todo.EViewModel`)**

- **共用層 (`Todo.FCommon`)**

---

### **2\. 控制器 (Controllers)**

位於 `Todo.WebApi\Controllers` 資料夾中的控制器負責處理進來的 HTTP 請求，調用相應的業務邏輯，並返回結果給客戶端。

**示例流程：**

1. **客戶端發送 HTTP 請求** → 

2. **控制器接收請求** → 

3. **控制器調用業務邏輯層的方法** → 

4. **業務邏輯層調用資料存取層進行資料操作** → 

5. **結果返回給控制器** → 

6. **控制器將結果返回給客戶端**

---

### **3\. 業務邏輯層 (Business Logic Layer)**

位於 `Todo.BLogicService` 資料夾中的服務類別負責處理應用程式的業務邏輯。這一層通常包含接口 (`Interface`) 和具體實現 (`Services`)。

**關鍵概念：**

- **服務接口 (Service Interfaces):** 定義業務邏輯的方法合約，位於 `Interface` 資料夾中。

- **服務實現 (Service Implementations):** 實現接口中的方法，負責具體的業務操作，位於 `Services` 資料夾中。

- **AutoMapper:** 使用 `AutoMapperProfiles` 配置對象映射，將實體模型轉換為視圖模型或 DTO。

---

### **4\. 資料存取層 (Repository Layer)**

位於 `Todo.CRepository` 資料夾中的存取層負責與資料庫進行互動，執行 CRUD 操作。這一層通常使用倉儲模式（Repository Pattern）來抽象化資料存取邏輯，提供一個乾淨的接口給業務邏輯層使用。

**關鍵概念：**

- **倉儲接口 (Repository Interfaces):** 定義資料存取的方法合約。

- **倉儲實現 (Repository Implementations):** 實現接口，負責具體的資料庫操作。

- **Entity Framework:** 常用的 ORM 工具，用於簡化資料庫操作。

---

### **5\. 實體層 (Entity Layer)**

位於 `Todo.DEntity` 資料夾中的實體層定義了資料庫中的實體模型，通常對應資料庫中的表格。這些實體類別用於 ORM（如 Entity Framework）進行資料映射。

**關鍵概念：**

- **實體類別 (Entity Classes):** 定義資料庫表結構的類別，包含屬性對應欄位。

- **DbContext:** 定義資料庫上下文，管理實體與資料庫的互動。

---

### **6\. 視圖模型層 (ViewModel Layer)**

位於 `Todo.EViewModel` 資料夾中的視圖模型層定義了傳輸給客戶端的資料結構（DTOs）。這些模型通常只包含客戶端需要的資料，避免直接暴露實體模型。

**關鍵概念：**

- **DTO (Data Transfer Objects):** 定義資料傳輸的結構，減少不必要的資料暴露。

- **AutoMapper:** 將實體模型轉換為 DTO，簡化資料映射過程。

---

### **7\. 共用層 (Common Layer)**

位於 `Todo.FCommon` 資料夾中的共用層包含應用程式中各個層級共享的工具類別、常量、擴展方法等。

**關鍵概念：**

- **工具類別 (Utility Classes):** 提供通用的方法，如日誌記錄、錯誤處理等。

- **常量 (Constants):** 定義應用程式中使用的常量值，避免硬編碼。

---

### **8\. 依賴注入 (Dependency Injection)**

您的專案使用 `Autofac` 進行依賴注入，這是一種管理類別之間依賴關係的設計模式。通過依賴注入，可以提高代碼的可測試性和可維護性。

**關鍵概念：**

- **模組配置 (AutofacModule):** 定義如何註冊各個服務和倉儲的依賴關係。

- **注入方式:** 通過構造函數注入、屬性注入等方式將依賴關係注入到需要的類別中。

---

### **9\. 中介軟體 (Middleware)**

位於 `Todo.WebApi\Middleware` 資料夾中的中介軟體負責處理 HTTP 請求和響應的管道，可以用來實現日誌記錄、錯誤處理、認證等功能。

**關鍵概念：**

- **自訂中介軟體 (Custom Middleware):** 實現特定的請求處理邏輯，如全局異常處理、請求日誌等。

- **管道配置 (Pipeline Configuration):** 在 `Program.cs` 中配置中介軟體的執行順序。

---

### **10\. 配置管理 (Configuration Management)**

配置文件如 `appsettings.json` 和 `appsettings.Development.json` 用於管理應用程式的配置設定，如資料庫連接字串、API 金鑰等。

**關鍵概念：**

- **環境特定配置:** 使用不同的配置文件管理不同環境（開發、測試、正式）的設定。

- **注入配置:** 通過依賴注入將配置值注入到需要的服務或控制器中。

---

### **11\. JWT 認證 (JWT Authentication)**

`JwtHelpers.cs` 類別可能負責處理 JSON Web Token（JWT）的生成和驗證，用於實現 API 的認證和授權。

**關鍵概念：**

- **Token 生成:** 在用戶登錄時生成 JWT，包含用戶身份和權限資訊。

- **Token 驗證:** 中介軟體或過濾器驗證進來的請求是否攜帶有效的 JWT，確保安全性。

---

### **12\. API 構建流程總結**

以下是一個典型的 API 請求處理流程，結合上述設計概念：

1. **客戶端發送 HTTP 請求** 到 API 端點。

2. **中介軟體 (Middleware)** 處理請求，如驗證 JWT。

3. **控制器 (Controller)** 接收請求，解析路由和參數。

4. \*\*控制器調用業務邏輯層 (Service)\*\*，傳遞必要的參數。

5. \*\*業務邏輯層調用資料存取層 (Repository)\*\*，進行資料庫操作。

6. **資料存取層與資料庫互動**，返回結果給業務邏輯層。

7. **業務邏輯層處理業務邏輯**，可能進行資料轉換或額外處理。

8. **業務邏輯層返回結果給控制器**。

9. \*\*控制器使用 AutoMapper 將實體轉換為 DTO (ViewModel)\*\*。

10. **控制器返回 HTTP 響應** 給客戶端，包含所需的資料。

---

### **13\. 其他重要文件**

- **`Program.cs`**: 應用程式的入口點，負責配置服務、依賴注入、中介軟體等。

- **`[README.md](README.md)`**: 專案說明文件，提供專案的概述、安裝步驟、使用說明等資訊。

- **`.gitignore`**: 定義不需要提交到版本控制的檔案和資料夾，確保敏感資訊和不必要的檔案不被版本控制系統追蹤。

- **`.editorconfig`**: 統一代碼風格設定，確保團隊成員使用一致的編碼風格。

---

### **總結**

這個資料夾結構展示了一個典型的 C# .NET 後端應用程式的設計方式，通過分層架構和各種設計模式，實現了高內聚、低耦合的系統結構。每個層級和模組都有明確的職責，確保代碼的可維護性和可擴展性。同時，使用依賴注入、AutoMapper、JWT 認證等技術，提升了應用程式的靈活性和安全性。

希望這些設計概念和流程說明能夠幫助您更好地理解和構建 C# 後端 API。