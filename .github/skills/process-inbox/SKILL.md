---
name: process-inbox
description: 一鍵處理 /000Inbox 中的文章：自動拆解卡片、建立卡片檔案、更新索引、歸檔原文。適用於用戶說「處理 Inbox」「整理收件匣」「process inbox」時。Use when user wants to process inbox articles into cards and archive originals.
---

# Skill: Process Inbox（Inbox 自動處理 Pipeline）

## 目標
一鍵處理 `/000Inbox/` 中的文章，自動完成「拆卡片 → 建檔 → 連結 → 更新索引 → 歸檔原文」的完整 CODE 流程，將原本需要 5+ 次手動操作的流程簡化為 1 個人工檢查點。

## Pipeline 總覽

```
[Step 1] SCAN     掃描 Inbox 列出待處理檔案
[Step 2] SELECT   用戶選擇要處理的檔案
[Step 3] BREAK    呼叫 break-cards 拆解文章
         ↓
【檢查點】用戶確認卡片清單、分類編號、標題
         ↓
[Step 4] CREATE   建立卡片檔案到 /003_2Cards/
[Step 5] LINK     呼叫 link-cards 建立卡片連結
[Step 6] INDEX    更新索引檔 /003_1CardsIndex/
[Step 7] ARCHIVE  歸檔原文到對應資料夾
         ↓
輸出處理摘要
```

## 執行流程（7 個 Step + 1 個檢查點）

### Step 1: SCAN（掃描）
**模式**：全自動

1. 掃描 `/000Inbox/` 中所有 `.md` 檔案
2. 對每個檔案讀取前 100 字作為預覽
3. 輸出待處理清單

**輸出格式**：
```markdown
## Inbox 待處理清單

| # | 檔名 | 預覽 |
|---|------|------|
| 1 | [filename.md] | [前 100 字...] |
| 2 | [filename.md] | [前 100 字...] |
```

**若 Inbox 為空**：輸出「Inbox 目前沒有待處理的檔案。」並結束。

---

### Step 2: SELECT（選擇）
**模式**：人工

讓用戶選擇要處理的檔案：
- 輸入編號（如 `1, 3, 5`）處理特定檔案
- 輸入「全部」處理所有檔案
- 可一次選多個，pipeline 會依序處理每個檔案

---

### Step 3: BREAK（拆解）
**模式**：全自動

對每個選中的檔案：
1. 讀取完整文章內容
2. 呼叫 `break-cards` skill 執行拆解，產出：
   - 主脈絡（論證骨架）
   - 候選卡片清單（每張含：標題、類型、概念、重要性、邊界/反例、關鍵詞）
   - 連結建議
3. 根據卡片內容，自動判斷每張卡片的**編號分類**（參照編號分類對照表）

**編號分類對照表**：
| 編號 | 索引文件 | 主題範疇 |
|------|----------|----------|
| 1- | Idx_1-CoreConcepts | 核心思維、策略原則、基礎概念 |
| 2- | Idx_2-PersonKnowledgeManage | 個人知識管理、學習方法、職涯發展 |
| 3- | Idx_3-AiApplication | AI 應用、LLM 產品、AI 產業分析 |
| 4- | Idx_4-AiCoding | AI 輔助編程、軟體工程、工程師職涯 |
| 5- | Idx_5-BusinessDataScience | 商業分析、數據科學、決策科學 |
| 6- | Idx_6-Databricks | Databricks 技術與實踐 |
| 7- | Idx_7-ProductManager | 產品管理、PM 思維、PMF 框架 |
| 8- | Idx_8-系統架構知識 | 系統架構、分散式系統、微服務 |
| 9- | Idx_9-軟體工程知識 | 軟體工程方法論、開發流程 |
| 10- | Idx_10-系統驗測與維運 | 系統測試、DevOps、SRE |
| 11- | Idx_11-投資理財房地產 | 投資策略、理財、房地產 |
| 12- | Idx_12-個人效率與成長 | 時間管理、個人成長、習慣養成 |
| 13- | Idx_13-AI寫作 | AI 輔助寫作、內容創作 |
| 14- | Idx_14-世界政經科技趨勢 | 全球趨勢、政經、產業變遷 |

**判斷邏輯**：
- AI 產品策略、AI 時代轉型 → 3-
- AI 輔助開發、工程師職涯 → 4-
- 產品開發、PMF、客戶理解 → 7-
- 個人學習、職涯發展 → 2-
- 通用策略思維、決策框架 → 1-
- 商業分析、數據決策 → 5-
- 一篇文章可能產生多個不同類別的卡片

---

### 【檢查點】確認卡片清單
**模式**：人工

向用戶呈現每個檔案的拆解結果：

```markdown
## 拆解結果：[原文檔名]

### 主脈絡
[3-6 行論證骨架]

### 擬建立的卡片
| # | 檔名 | 類型 | 標題 | 分類 |
|---|------|------|------|------|
| 1 | 1-[標題].md | Principle | [標題] | CoreConcepts |
| 2 | 3-[標題].md | Model | [標題] | AiApplication |
| 3 | 7-[標題].md | Heuristic | [標題] | ProductManager |

### 建議歸檔位置
原文：[filename.md] → [推薦歸檔路徑] （理由：[...]）
```

**用戶可以**：
- 刪除不想保留的卡片（輸入「刪除 #2」）
- 修改分類編號（輸入「#3 改為 1-」）
- 修改標題（輸入「#1 標題改為 ...」）
- 修改歸檔位置
- 確認全部（輸入「確認」或「OK」）

---

### Step 4: CREATE（建立卡片檔案）
**模式**：全自動

對每張確認的卡片：
1. 在 `/003_2Cards/` 建立 `.md` 檔案
2. 檔名格式：`編號-標題.md`（如 `3-AI Agent 的本質.md`）
3. 卡片內容格式：

```markdown
# [標題]

## 概念
[50-220 字的完整描述]

## 重要性
[為什麼它是可組裝節點]

## 邊界/反例
[適用條件、限制、反例]

## 可連結關鍵詞
#關鍵詞A #關鍵詞B #關鍵詞C

---
來源：[[原文檔名]]
建立日期：[今天日期]
```

---

### Step 5: LINK（建立連結）
**模式**：全自動

對每張新建的卡片：
1. 呼叫 `link-cards` skill，搜尋 `/003_2Cards/` 中的關聯卡片
2. 從 link-cards 的結果中取得 3-7 張最相關的連結卡片
3. 在卡片檔案末尾追加連結區塊：

```markdown
## 相關卡片
- [[關聯卡片名]] - [連結類型: 互補/延伸/因果/對照/前提/例證/反例] - [連結理由]
```

---

### Step 6: INDEX（更新索引）
**模式**：全自動

對每張新建的卡片：
1. 根據卡片編號，找到對應的索引檔（`/003_1CardsIndex/Idx_X-類別.md`）
2. 讀取索引檔，找到最合適的段落標題（## 區塊）
3. 在該區塊下新增 `[[卡片檔名]]`（不含 .md）
4. 如果沒有合適的段落，新增一個 `##` 段落

**Obsidian 連結格式**：`[[編號-標題]]`

---

### Step 7: ARCHIVE（歸檔原文）
**模式**：半自動

對每個已處理的原文檔案，根據內容性質推薦歸檔位置：

| 原文性質 | 歸檔目的地 | 判斷依據 |
|----------|-----------|----------|
| 有大量未萃取的參考價值 | `/005_1Resource/[子分類]/` | 原文內容遠多於卡片萃取的部分 |
| 書籍筆記或書摘 | `/005_2Ebook/` | 檔名或內容含書名、章節 |
| 與進行中專案相關 | `/001_1Projects/` | 內容與特定專案直接相關 |
| 與長期領域相關 | `/001_2Area/` | 內容與持續維護的領域相關 |
| 已被完全萃取為卡片 | `/006Archive/` | 所有核心觀點都已成為卡片 |
| 低價值、無需保留 | 刪除 | 用戶確認不需保留 |

**`/005_1Resource/` 子分類**：
- `/AI/` — AI 趨勢、策略、產業影響
- `/LLM_Tools/` — Claude、Anthropic、LLM 應用/框架
- `/Dev_Engineering/` — 軟體開發、架構、資安
- `/Product_Business/` — 產品管理、商業模式
- `/Reference/` — 學習資源、概念說明
- `/IoT_Domain/` — IoT、車載、數位看板
- `/Projects_Misc/` — 其他雜項

**向用戶確認**：
```
原文 [filename.md] 處理完成。
推薦歸檔：/005_1Resource/AI/（理由：含大量 AI 趨勢分析尚未萃取）
確認？或指定其他位置：
```

---

## 批次處理

當用戶選擇多個檔案時：
1. **Step 3 (BREAK)** 逐一拆解每個檔案
2. **檢查點** 統一呈現所有檔案的拆解結果，一次確認
3. **Step 4-6 (CREATE/LINK/INDEX)** 批次執行所有卡片的建立、連結、索引
4. **Step 7 (ARCHIVE)** 逐一確認每個原文的歸檔位置

---

## 處理摘要

全部完成後輸出摘要：

```markdown
## Inbox 處理摘要

### 已處理檔案
| 原文 | 產出卡片數 | 歸檔位置 |
|------|-----------|----------|
| [filename] | X 張 | [歸檔路徑] |

### 新增卡片
| 卡片檔名 | 分類 | 關聯卡片數 |
|----------|------|-----------|
| [[編號-標題]] | [類別] | X 張 |

### 已更新索引
- Idx_X-類別.md：新增 X 張卡片
- Idx_Y-類別.md：新增 X 張卡片

### Inbox 狀態
- 處理前：X 個檔案
- 處理後：X 個檔案（剩餘未處理）
```

## 操作指引

**觸發條件**：
- 用戶說「處理 Inbox」「整理收件匣」「處理待辦文章」
- 用戶說「process inbox」「clean up inbox」
- 用戶說「Inbox 有新文章」「幫我拆 Inbox 的文章」

**前置條件**：
- `/000Inbox/` 中至少有一個 `.md` 檔案

## 禁止事項

- ❌ 不要在未經用戶確認的情況下刪除 Inbox 中的原文
- ❌ 不要覆蓋 `/003_2Cards/` 中已存在的同名卡片（如遇重名，加上後綴或提示用戶）
- ❌ 不要跳過檢查點，卡片品質必須經過人工確認
- ❌ 不要修改已存在的卡片內容（link-cards 的連結建議只追加在新卡片上）
- ❌ 不要將 break-cards 的拆解結果直接附加到原文末尾（與獨立使用 break-cards 不同，pipeline 中拆解結果直接轉為卡片檔案）

## 品質檢查

完成後自我檢查：
- ✅ 所有確認的卡片都已建立在 `/003_2Cards/`
- ✅ 每張卡片的命名符合 `編號-標題.md` 格式
- ✅ 每張卡片都有完整的內容（概念、重要性、邊界、關鍵詞）
- ✅ 對應的索引檔都已更新
- ✅ 原文已歸檔到用戶確認的位置
- ✅ Inbox 中已處理的檔案已被移走
